---
title: "rmd_wrangling"
format: html
editor: visual
---

## Load Packages

```{r}
#| output: false
if (!require(librarian)){
  install.packages("librarian")
  library(librarian)
}

librarian::shelf(tidyverse, RPostgres, DBI, here, lubridate, stringr, janitor, parsedate)

```

## read in raw data
```{r}
#| message: false

files <- list.files(here("raw_data"))

for (i in 1:length(files)) {
  
  t <- read_csv(here("raw_data", files[i])) %>% 
         clean_names()
  
  z <- str_remove(files[i], ".csv")
  
  assign(z, t)
  
}

rm(t, z)
```

## clean site table
```{r}

clean_site_table <- Site_Info_piet5 %>% 
  mutate(across(.cols = c("site_name","property_name"), 
                .fn = ~str_to_lower(str_replace_all(., " ", "_"))),
         property_area_m2 = as.numeric(if_else(property_area_m2 == "#N/A", NA, property_area_m2)),
         meta_comm_1 = str_to_lower(str_replace_all(meta_comm_1, " ", "_")),
         across(.cols = c("refuge_code":"second_contact"),
                .fn = ~str_to_lower(str_replace_all(., " ", "_"))),
         across(.cols = c("class":"origin"),
                .fn = ~str_to_lower(str_replace_all(., " ", "_")))) %>% 
  select(!c(x1))


```

## wetland info
```{r}

clean_wetland_info <- Wetland_Info_piet9 %>% 
  mutate(across(.col = c("trophic_state", "land_usage", "tree_method", "m_or_f"),
                .fn = ~str_to_lower(str_replace_all(., " ", "_")))) %>% 
  select(!c(date, site_year)) %>% 
  unite(date, c("year", "month", "day"), sep = "-", na.rm = T) %>% 
  mutate(date = parse_date(date))

```

